# vim: set ft=sh:
pkgname=draft
pkgver=0.2.0-4
pkgdesc="Launcher for the reMarkable tablet which wraps around the standard interface"
section=remarkable-launchers
conflicts=oxide
maintainer="Matt√©o Delabre <spam@delab.re>"
license=Apache

origin=https://github.com/dixonary/draft-reMarkable.git
revision=5bd660a2fd07eba166c6110d2b48cfc58ee67e58

build() {
    qmake draft.pro -spec linux-oe-g++
    make
}

package() {
    install -D -m 755 -t "$pkgdir"/opt/bin "$srcdir"/draft

    install -d "$pkgdir"/opt/share/draft "$pkgdir"/usr/share
    ln -s /opt/share/draft "$pkgdir"/usr/share/draft
    cp -R "$srcdir"/qml "$pkgdir"/opt/share/draft
    cp -R "$srcdir"/js "$pkgdir"/opt/share/draft

    install -d "$pkgdir"/opt/etc/draft "$pkgdir"/etc
    ln -s /opt/etc/draft "$pkgdir"/etc/draft
    cp -R "$srcdir"/extra-files/draft/* "$pkgdir"/opt/etc/draft
    sed -i 's,call=/usr,call=/opt,' "$pkgdir"/opt/etc/draft/02-fingerterm

    install -D -m 644 -t "$pkgdir"/lib/systemd/system "$defdir"/draft.service
}
